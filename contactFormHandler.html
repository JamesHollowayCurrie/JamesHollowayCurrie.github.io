<!DOCTYPE html>
<title>JHC Media - Contact Me</title>

<?php include("Assets/Includes/CommonMetadata.php")?>

<style type="text/css" media="all">
form
{
	margin: 1em 0;
	padding-bottom: 2em;
}

form fieldset
{
	padding: 4px;
	border: none;
}

label, input, textarea
{
	display: block;
}

input, textarea, legend
{
	margin-bottom: 2em;
}

input#submit
{
	margin-bottom: 0em;
}

legend, label.error
{
	color: red;
}

legend
{
	margin-bottom: 20px;	
}

input.error, textarea.error
{
	background: #faa;
}

</style>
</head>
<body>

<div id="wrapper">

<?php include("Assets/Includes/BannerAndNavBar.php")?>

<div id="content">

<h2>Contact Me</h2>
<?php 

$email = $_POST['email'];
$message = $_POST['message'];
$formError = false;

if (!filter_var($email, FILTER_VALIDATE_EMAIL))
{$formError = true; $emailError = true;}

if (strlen($message) < 12 || strlen($message) > 900)
{$formError = true; $messageError = true;}

if($formError)
{

?>

<form action="contactFormHandler.php" method="post">
<fieldset>
<legend>There was an error sending your email. Please follow the instructions below to correct it.</legend>

<label for="to" accesskey="t">To: </label>
<input maxlength="58" size="60" name="to" id="to" readonly value="JHC Media"/>

<label for="email" accesskey="e" class="<?php if($emailError){echo("error");}?>">From: <?php if($emailError){echo("Please ensure this email is valid.");}?></label>
<input type="text" maxlength="58" size="60" name="email" id="email" class="<?php if($emailError){echo("error");}?>" value="<?php echo($email);?>"/>

<label for="message" accesskey="m" class="<?php if($messageError){echo("error");}?>">Message: <?php if($messageError){echo("Must be at least 12 and no more than 900 characters in length.");}?></label>
<textarea rows="8" cols="60" name="message" id="message" class="<?php if($messageError){echo("error");}?>"><?php echo($message);?></textarea>

<input id="submit" type="submit" value="Send"/>

</fieldset>


</form>

<?php }

else
{
	$sender = $email;//optional but clarifies this is the senders address
	$recipient = "james.holloway-currie@jhcmedia.ca";
	$subject = "New Message From: ".$sender;
	
	$headers = "From: ".$sender."\r\n";
	$headers .= "MIME-version: 1.0\r\n";
	$headers .= "Content-Type: text/html; charset=utf-8\r\n";
	$message = "<h1>New message from:".$sender."</h1>".$message;
	
	mail($recipient, $subject, $message, $headers);
	
	echo '<p style="padding-bottom: 3em;">Thank you for your time. Your message has been sent successfully! <a href="index.php">Return Home</a></p>';
}

?>
</div>

<?php include("Assets/Includes/Footer.php")?>

</div>
</div>
</body>
</html>